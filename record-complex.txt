record Pair begin
  prom: Promise*(Int);
  int: Int
end

func write(p: Promise*(Int), value: Int): Unit begin
  p <- value
end

func applyPair(pair: Pair): Unit begin
  match pair begin
    { prom = p, int = i } -> write(p, i)
  end
end

func main(): Unit begin
  let p: Promise*(Int) = promise Int in
  let q: Promise*(Int) = promise Int in
  let r: Pair = Pair { prom = p, int = 1 } in
  let s: Pair = Pair { prom = q, int = 2 } in
  applyPair(r);
  applyPair(s)
end
