func add(sum: Promise*(Int), a: Promise(Int), b: Promise(Int)): Unit begin
  let aVal: Int = ?a in
  let bVal: Int = ?b in
  sum <- aVal
end

func f(x: Promise*(Int)): Unit begin
  x <- 10
end

func main(): Int begin
  let sum: Promise*(Int) = promise Int in
  let a: Promise*(Int) = promise Int in
  let b: Promise*(Int) = promise Int in
  let _: Unit = async add(sum, a, b) in
  let _: Unit = async f(a) in
  let _: Unit = async f(b) in
  ?sum
end